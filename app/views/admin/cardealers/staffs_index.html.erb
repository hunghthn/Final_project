
<body>

    <!--=================================
      loading -->
    
      <div id="loading">
        <div id="loading-center">
          <img src="<%= asset_path('loader/loader.gif') %>" alt="">
       </div>
      </div>
    
    <!--=================================
      loading -->
    
    
    <!--=================================
     header -->
    
     <header id="header" class="defualt">
        <div class="topbar">
          <div class="container">
            <div class="row">
              <div class="col-lg-6 col-md-12">
                <div class="topbar-left text-lg-start text-center">
                   <ul class="list-inline">
                     <li> <i class="fa fa-envelope-o"> </i> hungchv16@gmail.com</li>
                     <li> <i class="fa fa-clock-o"></i> Mon - Sat 8.00 - 18.00. Sunday CLOSED</li>
                   </ul>
                </div>
              </div>
              <div class="col-lg-6 col-md-12">
                <div class="topbar-right text-lg-end text-center">
                   <ul class="list-inline">
                     <li> <i class="fa fa-phone"></i> 0386680574</li>
                     <li><a href="#"><i class="fa fa-facebook"></i></a></li>
                     <li><a href="#"><i class="fa fa-twitter"></i></a></li>
                     <li><a href="#"><i class="fa fa-instagram"></i></a></li>
                     <li><a href="#"><i class="fa fa-youtube-play"></i></a></li>
                   </ul>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!--=================================
         mega menu -->
        
        <div class="menu">
          <!-- menu start -->
           <nav id="menu" class="mega-menu">
            <!-- menu list items container -->
            <section class="menu-list-items">
             <div class="container">
              <div class="row">
               <div class="col-md-12 position-relative">
                <!-- menu logo -->
                <ul class="menu-logo">
                    <li>
                        <a href=<%= car_show_path %>><img id="logo_img" src="<%= asset_path('logo/logo-light.png') %>" alt="logo"></a>
                    </li>
                </ul>
                <!-- menu links -->
                <ul class="menu-links">
                    <!-- active class -->
                    <li><a href="<%= car_show_path %>">Home</a></li>
                    <li><a href="javascript:void(0)">So sánh <i class="fa fa-angle-down fa-indicator"></i></a>
                      <div class="drop-down menu-bg grid-col-12">
                        <div class="grid-row" id="list-compared">
                          <%= render partial: 'car/compared_models', locals: { compared_models: session[:compared_models] } %>
                        </div>
                        <div class="grid-row" id ="compare_button">
                          <%= link_to "So sánh", car_compare_compare_path, class: "button red float-end" %>
                        </div> 
                      </div>
                    </li>
                    <li><a href="<%= cardealers_path %>">CARDEALER</a></li>
                    <li><a href="javascript:void(0)">top doanh số   <i class="fa fa-angle-down fa-indicator"></i></a>
                       <!-- drop down multilevel  -->
                        <ul class="drop-down-multilevel">
                            <li><%= link_to "Cả năm 2023", sales_index_path %></li>
                        </ul>
                    </li>
                    <li>
                      <% if current_user %>
                      <a href="javascript:void(0)"> <%= current_user.firstname %>  <i class="fa fa-angle-down fa-indicator"></i></a>
                       <ul class="drop-down-multilevel">
                        <% if current_user.admin_car_dealer? %>
                  <li><%= link_to "Admin", admin_cardealer_path(current_user.cardealer) %></li>
                <% else %>
                  <li><%= link_to "Tài khoản", user_path(current_user) %></li>
                <% end %>
                        <li><%= link_to "Đăng xuất", logout_path, method: :delete %>
                        </li>
                       </ul>
                      <% else %>
                        <%= link_to "Đăng nhập", login_path %>
                      <% end %>
                    </li>
                  </ul>
               </div>
              </div>
             </div>
            </section>
           </nav>
          <!-- menu end -->
         </div>
        </header>
    
    <!--=================================
     header -->
    
    
    <!--=================================
     inner-intro -->
    
     <section class="inner-intro bg-1 bg-overlay-black-70">
      <div class="container">
         <div class="row text-center intro-title">
               <div class="col-md-6 text-md-start d-inline-block">
                 <h1 class="text-white">Trang quản lý Car Dealer</h1>
               </div>
               <div class="col-md-6 text-md-end float-end">
                 <ul class="page-breadcrumb">
                    <li><a href="#"><i class="fa fa-home"></i> Trang chủ</a> <i class="fa fa-angle-double-right"></i></li>
                    <li><a href="#">Admin</a> <i class="fa fa-angle-double-right"></i></li>
                    <li><span><%= @cardealer.name %></span> </li>
                 </ul>
               </div>
         </div>
      </div>
    </section>
    
    <!--=================================
     inner-intro -->
    
    
    <!--=================================
    left-sidebar  -->
    
    <section class="page-left-sidebar page-section-ptb">
      <div class="container">
        <div class="row">
          <div class="col-md-3">
            <div class="blog-sidebar">
              <div class="sidebar-widget">
                <h6>Các chức năng</h6>
                <div class="widget-link mb-md-0 mb-5">
                   <ul>
                    <li><%= link_to '<i class="fa fa-angle-right"></i> Các yêu cầu tư vấn'.html_safe, inquiries_all_admin_cardealer_path(@cardealer) %></li>
                    <li><%= link_to '<i class="fa fa-angle-right"></i> Nhân sự'.html_safe, staffs_admin_cardealer_path(@cardealer) %></li>
                    <li><%= link_to '<i class="fa fa-angle-right"></i> Các mẫu xe đang có'.html_safe, models_admin_cardealer_path(@cardealer) %></li>
                   </ul>
                  </div>
              </div>
            </div>
          </div>
            <div class="col-md-9">
                <section class="our-team white-bg page-section-ptb" style="padding-top: 0;">
                  <section class="car-details page-section-ptb" style="padding: 0px;">
                  <div class="container" style="margin-top: 0px;">
                  <div class="row" style="padding-top: 0px;">
                    <div class="details-nav" style="padding-bottom: 20px; margin: 0px;">
                      <ul>
                        <li>
                          <a href="#" data-bs-toggle="modal" data-bs-target="#exampleModal">
                           <i class="fa fa-plus-circle"></i>Thêm nhân sự
                          </a>
                          <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                            <div class="modal-dialog" role="document">
                              <div class="modal-content">
                                <div class="modal-header">
                                  <h4 class="modal-title" id="exampleModalLabel">Thêm nhân sự</h4>
                                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">×</button>
                                </div>
                                <div class="modal-body">
                                  <form class="gray-form reset_css"  action="<%= car_dealer_employees_path %>" method="post">
                                    <%= hidden_field_tag :authenticity_token, form_authenticity_token %>
                                    <input type="hidden" name="car_dealer_employee[cardealer_id]" value="<%= @cardealer.id %>">
                                    <div class="mb-3">
                                      <label class="form-label">Tên*</label>
                                      <input type="text" class="form-control" name="car_dealer_employee[name]" id="rmi_name" />
                                    </div>
                                    <div class="mb-3">
                                      <label class="form-label pe-3">Vai trò*</label>
                                      <div class="form-check form-check-inline">
                                        <input class="form-check-input" type="radio" name="car_dealer_employee[role]" id="flexRadioDefault1" value="1">
                                        <label class="form-check-label p-0 text-uppercase" for="flexRadioDefault1">
                                          Quản Lý
                                        </label>
                                      </div>
                                      <div class="form-check form-check-inline">
                                        <input class="form-check-input" type="radio" name="car_dealer_employee[role]"  id="flexRadioDefault2" value="2" checked>
                                        <label class="form-check-label p-0 text-uppercase" for="flexRadioDefault2">
                                          Chuyên viên tư vấn
                                        </label>
                                      </div>
                                    </div>
                                    <div class="mb-3">
                                      <label class="form-label pe-3">Giới tính*</label>
                                      <div class="form-check form-check-inline">
                                        <input class="form-check-input" type="radio" name="car_dealer_employee[gender]" id="flexRadioDefault3" value="male">
                                        <label class="form-check-label p-0 text-uppercase" for="flexRadioDefault3">
                                          Nam
                                        </label>
                                      </div>
                                      <div class="form-check form-check-inline">
                                        <input class="form-check-input" type="radio" name="car_dealer_employee[gender]"  id="flexRadioDefault4" value="female" checked>
                                        <label class="form-check-label p-0 text-uppercase" for="flexRadioDefault4">
                                          Nữ
                                        </label>
                                      </div>
                                    </div>
                                    <div class="mb-3">
                                      <label class="form-label">Thông tin</label>
                                      <textarea class="form-control" name="car_dealer_employee[detail]"  id="rmi_message"></textarea>
                                    </div>
                                    <div>
                                      <button type="submit" class="button red" >Gửi <i class="fa fa-spinner fa-spin fa-fw btn-loader" style="display: none;"></i></button>
                                    </div>
                                  </form>
                                </div>
                              </div>
                            </div>
                          </div>



                        </li>
                      </ul>
                    </div>
                  </div>
                  </div>
                  </section>
                    <div class="container">
                      <div class="row">
                        <% @staffs.each_slice(4) do |staffs_row| %>
                          <div class="row">
                            <% staffs_row.each do |staff| %>
                              <% modal_id = "customModal-#{staff.id}" %>
                              <div class="col-lg-3 col-md-6 col-sm-6">
                                <div class="team text-center">
                                  <div class="team-image">
                                    <% if staff.gender == 'male' %>
                                    <img class="img-fluid" src="<%= asset_path('car_delealer_employee/02.jpg') %>" alt="">
                                    <% else %>
                                    <img class="img-fluid" src="<%= asset_path('car_delealer_employee/01.jpg') %>" alt="">
                                    <% end %>
                                    <div class="team-social">
                                      <ul>
                                        <li><a class="icon-1"  data-bs-toggle="modal" data-bs-target="#<%= modal_id %>"
                                          data-name="<%= staff.name %>" 
                                          data-gender="<%= staff.gender %>"
                                          data-role="<%= staff.role %>" 
                                          data-detail="<%= staff.detail %>"
                                          ><i class="fa fa-pencil"></i></a>
                                          <div class="modal fade" id="<%= modal_id %>" tabindex="-1" role="dialog" aria-labelledby="customModalLabel" aria-hidden="true" >
                                            <div class="modal-dialog" role="document">
                                              <div class="modal-content" style="padding: 20px; margin-top: 120px;">
                                                <div class="modal-header" style="    border-bottom: 0px;
                                                background: #323232;
                                                padding: 15px 26px;
                                                margin: 10px;
                                                color: #ffffff;">
                                                  <h5 class="modal-title" id="customModalLabel" style="color: #ffffff;">Chỉnh sửa thông tin</h5>
                                                  <button type="button" class="btn-close custom-close" data-bs-dismiss="modal" aria-label="Close"></button>

                                                </div>
                                                <div class="modal-body">
                                                  <form id="editForm-<%= staff.id %>" action="<%= car_dealer_employee_path(staff.id) %>" method="post">
                                                    <%= hidden_field_tag :authenticity_token, form_authenticity_token %>
                                                    <input type="hidden" name="_method" value="put">
                                                  
                                                    <div class="mb-3">
                                                      <label for="name" class="form-label">Tên</label>
                                                      <input type="text" class="form-control" id="edit-name-staff-<%= staff.id %>" value="<%= staff.name %>" name="car_dealer_employee[name]">
                                                    </div>
                                                    <div class="mb-3 pt-3">
                                                      <div class="row align-items-center">
                                                        <label class="form-label col-auto pe-3" style="margin-bottom: 0px; margin-left:10px;">Vai trò</label>
                                                        <div class="col">
                                                          <div class="form-check form-check-inline">
                                                            <input class="form-check-input" type="radio" style="margin-top: 7.2px; margin-right: 10px;" name="car_dealer_employee[role]" id="edit-role_manager-<%= staff.id %>" value="1" <%= staff.role == "Quản Lý" ? 'checked' : '' %>>
                                                            <label class="form-check-label p-0 " for="role_manager">Quản Lý</label>
                                                          </div>
                                                          <div class="form-check form-check-inline">
                                                            <input class="form-check-input" type="radio" style="margin-top: 7.2px; margin-right: 10px;" name="car_dealer_employee[role]" id="edit-role_manager-<%= staff.id %>" value="2" <%= staff.role == "Chuyên viên tư vấn" ? 'checked' : '' %>>
                                                            <label class="form-check-label p-0 " for="role_consultant">Chuyên viên tư vấn</label>
                                                          </div>
                                                        </div>
                                                      </div>
                                                    </div>
                                                    
                                                    <div class="mb-3 pt-3">
                                                      <div class="row align-items-center">
                                                        <label class="form-label col-auto pe-3" style="margin-bottom: 0px; margin-left:10px;">Giới tính</label>
                                                        <div class="col">
                                                          <div class="form-check form-check-inline">
                                                            <input class="form-check-input" name="car_dealer_employee[gender]" style="margin-top: 7.2px; margin-right: 10px;" type="radio" name="gender-<%= staff.id %>" id="edit-gender_male-<%= staff.id %>" value="male" <%= staff.gender == 'male' ? 'checked' : '' %>>
                                                            <label class="form-check-label p-0" for="gender_male">Nam</label>
                                                          </div>
                                                          <div class="form-check form-check-inline">
                                                            <input class="form-check-input" name="car_dealer_employee[gender]" style="margin-top: 7.2px; margin-right: 10px;" type="radio" name="gender-<%= staff.id %>" id="edit-gender_female-<%= staff.id %>" value="female" <%= staff.gender == 'female' ? 'checked' : '' %>>
                                                            <label class="form-check-label p-0" for="gender_female">Nữ</label>
                                                          </div>
                                                        </div>
                                                      </div>
                                                    </div>

                                                    <div class="mb-3">
                                                      <label for="detail" class="form-label">Thông tin</label>
                                                      <textarea class="form-control" name="car_dealer_employee[detail]" id="edit-detail-staff-<%= staff.id %>" placeholder="Enter details"><%= staff.detail %></textarea>
                                                    </div>
                                                    <div class="mb3">
                                                      <button type="submit" class="btn custom-save-btn">Lưu thay đổi</button>
                                                    </div>
                                                  </form>
                                                </div>
                                              </div>
                                            </div>
                                          </div></li>
                                        <li>
                                          <a class="icon-2" href="#" data-bs-toggle="modal" data-bs-target="#deleteConfirmModal" data-user-id="USER_ID">
                                            <i class="fa fa-trash-o"></i>
                                          </a>
                                          <div class="modal fade" id="deleteConfirmModal" tabindex="-1" role="dialog" aria-labelledby="deleteConfirmModalLabel" aria-hidden="true">
                                            <div class="modal-dialog" role="document">
                                              <div class="modal-content" style="padding: 20px; margin-top: 120px;">
                                                <div class="modal-header" style="border-bottom: 0px; background: #323232; padding: 15px 26px; margin: 10px; color: #ffffff;">
                                                  <h5 class="modal-title" id="deleteConfirmModalLabel" style="color: #ffffff;">Xác Nhận Xóa</h5>
                                                  <button type="button" class="btn-close custom-close" style="color: #ffffff;" data-bs-dismiss="modal" aria-label="Close"></button>
                                                </div>
                                                <form id="deleteForm-<%= staff.id %>" action="<%= car_dealer_employee_path(staff.id) %>" method="post">
                                                  <input type="hidden" name="_method" value="delete">
                                                  <input type="hidden" name="authenticity_token" value="<%= form_authenticity_token %>">
                                                  <div class="modal-body">
                                                    <p style="color: black; text-align:center; font-size :medium">Bạn có chắc chắn muốn xóa người này không?</p>
                                                  </div>
                                                  <div class="modal-footer">
                                                    <button type="submit" class="btn custom-save-btn" id="confirmDelete">Xóa</button>
                                                  </div>
                                                </form>
                                              </div>
                                            </div>
                                          </div>
                                        </li>
                                      </ul>
                                      
                                    </div>

                                  </div>
                                  <div class="team-name">
                                    <h5 class="text-black"><%= staff.name %></h5>
                                    <span class="text-black"><%= staff.role %></span>
                                  </div>
                                </div>
                              </div>
                            <% end %>
                          </div>
                        <% end %>
                      </div>
                    </div>
                  </section>
            </div>
         </div>
       </div>
    </section>
    
    <!--=================================
    left-sidebar  -->
    
    
    <!--=================================
     footer -->
    
    <footer class="footer bg-3 bg-overlay-black-90">
      <div class="container">
        <div class="row">
         <div class="col-md-12">
          <div class="social">
            <ul>
              <li><a class="facebook" href="#">facebook <i class="fa fa-facebook"></i> </a></li>
              <li><a class="twitter" href="#">twitter <i class="fa fa-twitter"></i> </a></li>
              <li><a class="pinterest" href="#">pinterest <i class="fa fa-pinterest-p"></i> </a></li>
              <li><a class="dribbble" href="#">dribbble <i class="fa fa-dribbble"></i> </a></li>
              <li><a class="google-plus" href="#">google plus <i class="fa fa-google-plus"></i> </a></li>
              <li><a class="behance" href="#">behance <i class="fa fa-behance"></i> </a></li>
            </ul>
           </div>
          </div>
        </div>
      </div>
    </footer>
    
    <!--=================================
     footer -->
    
    
    
     <!--=================================
     back to top -->
    
    <div class="car-top">
      <span>
        <img  src="<%= asset_path('car.png') %>" alt="">
      </span>
    </div>
    
     <!--=================================
     back to top -->
     <script>
    
        $('.add-to-compare').on('click', function(e) {
          e.preventDefault();
        
          var modelId = $(this).data('model-id');
          var csrfToken = $('meta[name="csrf-token"]').attr('content');
        
          $.ajax({
            type: 'POST',
            url: '/car/add_to_compare',
            data: {
              model_id: modelId,
              authenticity_token: csrfToken
            },
            success: function(response) {
              console.log(response);
        
              $.ajax({
                type: 'GET',
                url: '/car/render_compared_models',
                success: function() {
                },
                error: function(error) {
                  console.log(error);
                }
              });
            },
            error: function(error) {
              console.log(error);
            }
          });
        });
        
        // Sử dụng event delegation cho phần tử cha tồn tại từ trước (body trong trường hợp này)
        $('body').on('click', '.remove-from-compare', function(e) {
          e.preventDefault();
        
          var modelId = $(this).data('model-id');
          var csrfToken = $('meta[name="csrf-token"]').attr('content');
        
          $.ajax({
            type: 'POST',
            url: '/car/remove_from_compare',
            data: {
              model_id: modelId,
              authenticity_token: csrfToken
            },
            success: function(response) {
              console.log(response);
              $.ajax({
                type: 'GET',
                url: '/car/render_compared_models',
                success: function() {
                },
                error: function(error) {
                  console.log(error);
                }
              });
            },
            error: function(error) {
              console.log(error);
            }
          });
        });
         
        </script>
    </body>
    
    